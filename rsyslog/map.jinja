{%- load_yaml as base_defaults %}
Debian:
  pkgs:
  - rsyslog
  service:
  - rsyslogd
  workdirectory: /var/spool/rsyslog
  output:
    file:
      /var/log/syslog:
        sync: false
        filter: "*.*;auth,authpriv.none"
        owner: syslog
        group: adm
        createmode: "0640"
        umask: "0022"
        enable: true
      /var/log/auth:
        sync: true
        filter: "auth,authpriv.*"
        owner: syslog
        group: adm
        createmode: "0640"
        umask: "0022"
        enable: true
      /var/log/kern:
        sync: false
        filter: "kern.*"
        owner: syslog
        group: adm
        createmode: "0640"
        umask: "0022"
        enable: true
      /var/log/mail.log:
        sync: false
        filter: "mail.*"
        owner: syslog
        group: adm
        createmode: "0640"
        umask: "0022"
        enable: true
      /var/log/mail.err:
        sync: false
        action: /var/log/mail.err
        filter: mail.err
        owner: syslog
        group: adm
        createmode: "0640"
        umask: "0022"
        enable: true
    console:
      wall:
        action: ":omusrmsg:*"
        filter: "*.emerg"
        enable: true
      xconsole:
        action: "|/dev/xconsole"
        filter: "daemon.*;mail.*; news.err; *.=debug;*.=info;*.=notice;*.=warn"
        enable: true
    remote:
      somehost.domain:
        action: "@@remote-host:514"
        filter: "*.*"
        enable: false
RedHat:
  pkgs:
  - rsyslog
  service:
  - rsyslogd
  workdirectory: /var/lib/rsyslog
  output:
    file:
      /var/log/messages:
        sync: true
        filter: "*.info;mail.none;authpriv.none;cron.none"
        owner: root
        group: root
        createmode: "0600"
        umask: "0000"
        enable: true
      /var/log/secure:
        sync: true
        filter: "authpriv.*"
        owner: root
        group: root
        createmode: "0600"
        enable: true
      /var/log/maillog:
        sync: true
        filter: "mail.*"
        owner: root
        group: root
        createmode: "0600"
        enable: true
      /var/log/cron:
        sync: true
        filter: "cron.*"
        owner: root
        group: root
        createmode: "0600"
        enable: true
      /var/log/spooler:
        sync: true
        filter: "uucp,news.crit"
        owner: root
        group: root
        createmode: "0600"
        enable: true
      /var/log/boot.log:
        sync: false
        filter: "local7.*"
        owner: root
        group: root
        createmode: "0600"
        enable: true
{%- endload %}
{%- set server = salt['grains.filter_by'](base_defaults, merge=salt['pillar.get']('rsyslog:server')) %}
{%- set client = salt['grains.filter_by'](base_defaults, merge=salt['pillar.get']('rsyslog:client')) %}
